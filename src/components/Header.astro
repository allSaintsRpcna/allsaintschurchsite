---
interface Props {
  transparentHeader?: boolean;
}

const { transparentHeader = false } = Astro.props;

import logo from "../assets/images/allsaints-logo2.png";
import { Image } from "astro:assets";
const navLinks = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/beliefs", label: "Beliefs" },
  { href: "/leadership", label: "Leadership" },
  { href: "/sermons", label: "Sermons" },
  { href: "/contact", label: "Contact" },
];

const currentPath = Astro.url.pathname;
---

<header
  id="site-header"
  class:list={[
    "fixed top-0 left-0 w-full z-50 transition-all duration-300",
    transparentHeader && "header-transparent",
  ]}
>
  <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
    <a
      href="/"
      class="header-logo text-xl font-semibold text-gray-900 hover:text-gray-700 transition-colors"
    >
      <Image
        src={logo}
        alt="All Saints Reformed Presbyterian Church"
        width={250}
        height={250}
      />
    </a>

    <!-- Mobile menu button -->
    <button
      id="menu-toggle"
      class="header-menu-btn md:hidden text-gray-700 hover:text-gray-900 transition-colors z-60"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          id="menu-icon"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
    </button>

    <!-- Desktop nav -->
    <nav class="hidden md:block">
      <ul class="flex gap-6">
        {
          navLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class:list={[
                  "header-nav-link text-sm transition-colors",
                  currentPath === link.href
                    ? "text-gray-900 font-medium"
                    : "text-gray-600 hover:text-gray-900",
                ]}
              >
                {link.label}
              </a>
            </li>
          ))
        }
      </ul>
    </nav>
  </div>
</header>

<!-- Full-page mobile menu modal -->
<div
  id="mobile-menu"
  class="fixed inset-0 z-50 md:hidden pointer-events-none opacity-0 invisible bg-slate-800/90 transition-all duration-400 ease-in-out"
>
  <!-- Close button -->
  <button
    id="menu-close"
    class="absolute top-4 right-4 text-white hover:text-gray-300 transition-colors p-2"
    aria-label="Close menu"
  >
    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M6 18L18 6M6 6l12 12"></path>
    </svg>
  </button>

  <nav class="flex items-center justify-center h-full">
    <ul
      id="mobile-menu-links"
      class="flex flex-col items-center gap-8 translate-y-6 transition-transform duration-400 ease-in-out"
    >
      {
        navLinks.map((link) => (
          <li>
            <a
              href={link.href}
              class:list={[
                "text-2xl transition-colors",
                currentPath === link.href
                  ? "text-white font-semibold"
                  : "text-white/70 hover:text-white",
              ]}
            >
              {link.label}
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
</div>

{!transparentHeader && <div id="header-spacer" class="h-[56px]" />}

<style>
  .header-transparent:not(.header-scrolled) .header-logo {
    color: white;
  }
  .header-transparent:not(.header-scrolled) .header-logo:hover {
    color: rgb(229 231 235);
  }
  .header-transparent:not(.header-scrolled) .header-nav-link {
    color: rgba(255, 255, 255, 0.85);
  }
  .header-transparent:not(.header-scrolled) .header-nav-link:hover {
    color: white;
  }
  .header-transparent:not(.header-scrolled) .header-menu-btn {
    color: white;
  }
  .header-transparent:not(.header-scrolled) .header-menu-btn:hover {
    color: rgb(229 231 235);
  }
</style>

<script>
  const header = document.getElementById("site-header");
  const toggle = document.getElementById("menu-toggle");
  const menu = document.getElementById("mobile-menu");
  const closeBtn = document.getElementById("menu-close");

  function updateHeader() {
    if (window.scrollY > 10) {
      header?.classList.add("bg-slate-200", "header-scrolled");
    } else {
      header?.classList.remove("bg-slate-200", "header-scrolled");
    }
  }

  const menuLinks = document.getElementById("mobile-menu-links");

  function openMenu() {
    menu?.classList.remove("pointer-events-none", "opacity-0", "invisible");
    menuLinks?.classList.remove("translate-y-6");
    document.body.style.overflow = "hidden";
    toggle?.setAttribute("aria-expanded", "true");
  }

  function closeMenu() {
    menu?.classList.add("pointer-events-none", "opacity-0", "invisible");
    menuLinks?.classList.add("translate-y-6");
    document.body.style.overflow = "";
    toggle?.setAttribute("aria-expanded", "false");
  }

  updateHeader();
  window.addEventListener("scroll", updateHeader);
  toggle?.addEventListener("click", openMenu);
  closeBtn?.addEventListener("click", closeMenu);
</script>
